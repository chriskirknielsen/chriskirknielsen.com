{% set notes = ['C','D','E','F','G','A','B'] %}
{% set octaves = 2 %}
{% set whitesPerOctave = 7 %}
{% set noteCount = (octaves * whitesPerOctave) + 1 %}
{% set keysStartX = 9.3 %}
{% set keysStartY = 26.3 %}
{% set whiteKeyWidth = 186.12 / noteCount | round(4) %}
{% set blackKeyWidth = whiteKeyWidth * 2/3 | round(4) %}
{% set whiteKeyCount = octaves * whitesPerOctave %}

{% set synthMarkup %}
<div
    class="about-synth"
    aria-label="MIDI keyboard"
>
    <div class="about-synth-groups">
        <div class="about-synth-group about-synth-speaker-wrap" aria-hidden="true">
            <div class="about-synth-speaker"></div>
        </div>
        <div class="about-synth-group">
            <div class="about-synth-group-label">WAVEFORM</div>
            <div class="about-synth-group-content">
                <div class="about-synth-waveform-labels">
                    <button onclick="document.getElementById('synth-waveform').value=1" type="button" class="button-reset" data-synth-type="sinewave" data-about-action="synth-set-type" aria-label="Sinewave waveform" lang="en">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="12" viewBox="0 0 20 12"><path fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" d="M2,6s2-8,8,0,8,0,8,0"/></svg>
                    </button>

                    <button onclick="document.getElementById('synth-waveform').value=2" type="button" class="button-reset" data-synth-type="triangle" data-about-action="synth-set-type" aria-label="Triangle waveform" lang="en">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="12" viewBox="0 0 20 12"><path fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" d="m2 10 8-8 8 8"/></svg>
                    </button>

                    <button onclick="document.getElementById('synth-waveform').value=3" type="button" class="button-reset" data-synth-type="square" data-about-action="synth-set-type" aria-label="Square waveform" lang="en">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="12" viewBox="0 0 20 12"><path fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" d="M2 10V2h8v8h8V2"/></svg>
                    </button>

                    <button onclick="document.getElementById('synth-waveform').value=4" type="button" class="button-reset" data-synth-type="sawtooth" data-about-action="synth-set-type" aria-label="Sawtooth waveform" lang="en">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="12" viewBox="0 0 20 12"><path fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" d="M2 10V2l16 8V2"/></svg>
                    </button>
                </div>
                <div class="about-synth-slider-wrap">
                    <input type="range" min="1" max="4" step="1" id="synth-waveform" value="1">
                </div>
            </div>
        </div>
    </div>

    <div class="about-synth-keys" style="--synth-white-keys: {{ whiteKeyCount + 1 }};">
        {% for w in range(0, noteCount) %}
            {% set noteIndex = w % 7 %}
            {% set note = notes[ noteIndex ] %}
            {% set octave = ((w / 7) | round(0, "floor")) + (1 if (noteIndex < 5) else 2) %}
            <button type="button" style="--synth-key-index: {{ w + 1 }}" class="button-reset" data-key="white" data-note="{{ note }}" data-octave="{{ octave }}" data-name="{{ note }}{{ octave }}">
                <span class="about-synth-key-label">{{ note }}{{ octave }}</span>
            </button>
        {% endfor %}
        
        {% for b in range(1, whiteKeyCount) %}
            {% set noteIndex = b % 7 - 1 %}
            {% set note = notes[ noteIndex ] %}
            {% set octave = ((b / 7) | round(0, "floor")) + (1 if (noteIndex < 5) else 2) %}
            {% if b % 7 !== 0 and ((b + 4) % 7 !== 0) %}
                <button type="button" style="--synth-key-index: {{ b + 1 }}" class="button-reset" data-key="black" data-note="{{ note }}#" data-octave="{{ octave }}" data-name="{{ note }}#{{ octave }}">
                    <span class="about-synth-key-label">{{ note }}#{{ octave }}</span>
                </button>
            {% endif %}
        {% endfor %}
    </div>
</div>
{% endset %}
{{ synthMarkup | htmlmin | safe }}